$schema: http://json-schema.org/draft-07/schema#
type: object
required:
  - name
  - endpoint
  - source
  - commands
properties:
  name:
    type: string
    pattern: "^[a-z0-9-]+$"
    minLength: 1
    maxLength: 64
  endpoint:
    type: string
    pattern: "^/webhooks/[a-z0-9-]+$"
  source:
    type: string
    enum: [github, jira, sentry, slack, gitlab, custom]
  command_prefix:
    type: string
    default: "@agent"
  commands:
    type: array
    minItems: 1
    items:
      type: object
      required:
        - name
        - target_agent
        - prompt_template
      properties:
        name:
          type: string
          pattern: "^[a-z0-9-]+$"
          minLength: 1
          maxLength: 64
        aliases:
          type: array
          items:
            type: string
            pattern: "^[a-z0-9-]+$"
        description:
          type: string
          default: ""
        target_agent:
          type: string
          minLength: 1
        prompt_template:
          type: string
          minLength: 1
        requires_approval:
          type: boolean
          default: false
  requires_signature:
    type: boolean
    default: true
  signature_header:
    type: string
  secret_env_var:
    type: string
  default_command:
    type: string
